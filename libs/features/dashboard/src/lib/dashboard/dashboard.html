<section class="dash">
  <header class="dash__header">
    <h2>Compliance Dashboard</h2>

    <label class="dash__loc">
      <span>Location</span>

      <select
        [(ngModel)]="selectedLocationId"
        (ngModelChange)="onLocationChange($event)"
        [disabled]="loadingLocations || !locations.length"
      >
        <option value="" *ngIf="!locations.length">
          {{ loadingLocations ? 'Loading locations…' : 'No locations found' }}
        </option>

        <option *ngFor="let loc of locations" [value]="loc.id">
          {{ locationLabel(loc) }}
        </option>
      </select>
    </label>
  </header>

  <div class="msg" *ngIf="message">{{ message }}</div>

  <div class="msg" *ngIf="loadingLocations">Loading residences…</div>
  <div class="msg" *ngIf="!loadingLocations && !locations.length">
    Create 1 residence first — then the dashboard will populate.
  </div>

  <section class="dash__grid" *ngIf="locations.length">
    <lib-compliance-summary-card
      *ngFor="let s of summaryData"
      [summary]="s"
      (viewDetails)="navigateTo($event)"
    ></lib-compliance-summary-card>
  </section>

  <section class="dash__alert" *ngIf="hasUrgentAlerts">
    <div class="alert">
      <strong>Critical issues:</strong>
      <ul>
        <li *ngFor="let a of alerts">⚠️ {{ a }}</li>
      </ul>
    </div>
  </section>

  <section class="dash__chart" *ngIf="locations.length">
    <lib-compliance-chart [data]="chartData"></lib-compliance-chart>
  </section>
</section>
